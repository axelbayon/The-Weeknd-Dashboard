<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Weeknd Dashboard</title>
    <base href="/Website/">
    <link rel="stylesheet" href="src/styles/global.css?v=8.0">
</head>
<body>
    <div class="app-shell">
        <!-- Navigation sticky -->
        <nav class="topbar">
            <div class="topbar__inner">
                <div class="topbar__brand">
                    <span class="topbar__title">The Weeknd Dashboard</span>
                </div>
                <ul class="topbar__nav-list">
                    <li>
                        <a href="#songs" class="topbar__link topbar__link--active" data-testid="nav-songs" data-page="songs">
                            Titres
                        </a>
                    </li>
                    <li>
                        <a href="#albums" class="topbar__link" data-testid="nav-albums" data-page="albums">
                            Albums
                        </a>
                    </li>
                    <li>
                        <a href="#caps" class="topbar__link" data-testid="nav-caps" data-page="caps">
                            Caps imminents
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- Contenu principal -->
        <main class="app-content">
            <div class="page-container">
                <!-- Page Songs (visible par défaut) -->
                <div id="page-songs" class="page page--songs" data-page-content="songs">
                    <div class="page-header">
                        <div class="page-header__cards">
                            <div class="stat-card" data-testid="header-last-sync">
                                <div class="stat-card__label">Dernière sync locale</div>
                                <div class="stat-card__value">—</div>
                            </div>
                            <div class="stat-card nu-card" data-testid="header-next-update">
                                <div id="nu-tip-songs" class="nu-tooltip" role="tooltip" hidden>
                                    <strong>INFOS SYNCHRONISATION</strong><br>
                                    La synchro est limitée par un délai de sécurité. Prochaine mise à jour estimée à
                                    <span class="nu-eta">—</span>.
                                </div>
                                
                                <div class="nu-header">
                                    <span class="nu-title">MISE À JOUR DES DONNÉES</span>
                                    <button class="nu-info" type="button" aria-describedby="nu-tip-songs" aria-label="Informations"></button>
                                </div>
                                
                                <div class="nu-body">
                                    <span class="nu-badge" aria-live="polite">—</span>
                                </div>
                            </div>
                            <div class="stat-card" data-testid="header-spotify-data-date">
                                <div class="stat-card__label">Date des données actuelles</div>
                                <div class="stat-card__value">—</div>
                            </div>
                        </div>
                    </div>

                    <div class="page-header page-header--aggregate">
                        <div class="page-header__cards">
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label">Nombre total de titres</div>
                                <div class="stat-card__value">—</div>
                            </div>
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label">Nombre total de streams</div>
                                <div class="stat-card__value">—</div>
                            </div>
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label">Nombre de streams quotidiens <span data-testid="daily-streams-date">(—)</span></div>
                                <div class="stat-card__value">—</div>
                            </div>
                        </div>
                    </div>

                    <div class="page-header page-header--split">
                        <div class="page-header__cards">
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__header">
                                    <div class="stat-card__label">Titres en Solo / Lead</div>
                                </div>
                                <dl class="stat-card__rows">
                                    <dt class="stat-card__row-label">Nombre de titres</dt>
                                    <dd class="stat-card__row-value">—</dd>
                                    <dt class="stat-card__row-label">Streams totaux</dt>
                                    <dd class="stat-card__row-value">—</dd>
                                    <dt class="stat-card__row-label">Streams quotidiens</dt>
                                    <dd class="stat-card__row-value">—</dd>
                                </dl>
                            </div>
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__header">
                                    <div class="stat-card__label">Titres en Feat</div>
                                </div>
                                <dl class="stat-card__rows">
                                    <dt class="stat-card__row-label">Nombre de titres</dt>
                                    <dd class="stat-card__row-value">—</dd>
                                    <dt class="stat-card__row-label">Streams totaux</dt>
                                    <dd class="stat-card__row-value">—</dd>
                                    <dt class="stat-card__row-label">Streams quotidiens</dt>
                                    <dd class="stat-card__row-value">—</dd>
                                </dl>
                            </div>
                        </div>
                    </div>

                    <section class="table-section">
                        <div class="table-wrapper table-wrapper--has-hscroll">
                            <table class="data-table data-table--songs" data-testid="songs-table">
                                <caption class="data-table__caption">Liste des songs The Weeknd</caption>
                                <thead>
                                    <tr>
                                        <th scope="col" class="cell-num" data-sort-key="rank">
                                            <span class="data-table__header-text">#</span>
                                        </th>
                                        <th scope="col" class="col-title" data-sort-key="title" data-sort-type="title">
                                            <div class="data-table__header-wrapper">
                                                <button type="button" class="data-table__sort-button">
                                                    <span class="data-table__header-text">Titres</span>
                                                </button>
                                                <span class="data-table__legend">* = featuring</span>
                                            </div>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric cell-num" data-sort-key="streams_total">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Streams totaux</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric cell-num" data-sort-key="streams_daily">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Streams quotidiens</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric cell-num" data-sort-key="variation_pct">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Variation (%)</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric cell-num" data-sort-key="days_to_next_cap">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Prochain cap (j)</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric cell-num" data-sort-key="next_cap_value">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Prochain palier</span>
                                            </button>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="data-table__cell--rank cell-num">1</td>
                                        <td class="data-table__cell--title col-title">
                                            <div class="data-table__title-wrapper">
                                                <div class="data-table__title-cover">
                                                    <div class="cover-placeholder">🎵</div>
                                                </div>
                                                <div class="data-table__title-meta">
                                                    <div class="data-table__song-name">Blinding Lights</div>
                                                    <span class="data-table__album">After Hours</span>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="data-table__cell--numeric cell-num">4,123,456,789</td>
                                        <td class="data-table__cell--numeric cell-num">12,345,678</td>
                                        <td class="data-table__cell--numeric cell-num">
                                            <span class="data-table__delta--na">N.D.</span>
                                        </td>
                                        <td class="data-table__cell--numeric cell-num">—</td>
                                        <td class="data-table__cell--numeric cell-num">5B</td>
                                    </tr>
                                    <tr>
                                        <td class="data-table__cell--rank cell-num">2</td>
                                        <td class="data-table__cell--title col-title">
                                            <div class="data-table__title-wrapper">
                                                <div class="data-table__title-cover">
                                                    <div class="cover-placeholder">🎵</div>
                                                </div>
                                                <div class="data-table__title-meta">
                                                    <div class="data-table__song-name">Starboy</div>
                                                    <span class="data-table__album">Starboy</span>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="data-table__cell--numeric">3,987,654,321</td>
                                        <td class="data-table__cell--numeric">8,765,432</td>
                                        <td class="data-table__cell--numeric">
                                            <span class="data-table__delta--na">N.D.</span>
                                        </td>
                                        <td class="data-table__cell--numeric">—</td>
                                        <td class="data-table__cell--numeric">4B</td>
                                    </tr>
                                    <tr>
                                        <td class="data-table__cell--rank">3</td>
                                        <td class="data-table__cell--title">
                                            <div class="data-table__title-wrapper">
                                                <div class="data-table__title-cover">
                                                    <div class="cover-placeholder">🎵</div>
                                                </div>
                                                <div class="data-table__title-meta">
                                                    <div class="data-table__song-name">The Hills</div>
                                                    <span class="data-table__album">Beauty Behind the Madness</span>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="data-table__cell--numeric">2,876,543,210</td>
                                        <td class="data-table__cell--numeric">5,432,109</td>
                                        <td class="data-table__cell--numeric">
                                            <span class="data-table__delta--na">N.D.</span>
                                        </td>
                                        <td class="data-table__cell--numeric">—</td>
                                        <td class="data-table__cell--numeric">3B</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                </div>

                <!-- Page Albums (cachée par défaut) -->
                <div id="page-albums" class="page page--albums" data-page-content="albums" style="display: none;">
                    <div class="page-header">
                        <div class="page-header__cards">
                            <div class="stat-card" data-testid="header-last-sync">
                                <div class="stat-card__label">Dernière sync locale</div>
                                <div class="stat-card__value">—</div>
                            </div>
                            <div class="stat-card nu-card" data-testid="header-next-update">
                                <div id="nu-tip-albums" class="nu-tooltip" role="tooltip" hidden>
                                    <strong>INFOS SYNCHRONISATION</strong><br>
                                    La synchro est limitée par un délai de sécurité. Prochaine mise à jour estimée à
                                    <span class="nu-eta">—</span>.
                                </div>
                                
                                <div class="nu-header">
                                    <span class="nu-title">MISE À JOUR DES DONNÉES</span>
                                    <button class="nu-info" type="button" aria-describedby="nu-tip-albums" aria-label="Informations"></button>
                                </div>
                                
                                <div class="nu-body">
                                    <span class="nu-badge" aria-live="polite">—</span>
                                </div>
                            </div>
                            <div class="stat-card" data-testid="header-spotify-data-date">
                                <div class="stat-card__label">Date des données actuelles</div>
                                <div class="stat-card__value">—</div>
                            </div>
                        </div>
                    </div>

                    <div class="page-header page-header--aggregate">
                        <div class="page-header__cards">
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label">Nombre total d'albums</div>
                                <div class="stat-card__value">—</div>
                            </div>
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label">Nombre total de streams</div>
                                <div class="stat-card__value">—</div>
                            </div>
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label">Nombre de streams quotidiens <span data-testid="daily-streams-date-albums">(—)</span></div>
                                <div class="stat-card__value">—</div>
                            </div>
                        </div>
                    </div>

                    <section class="table-section">
                        <div class="table-wrapper table-wrapper--has-hscroll">
                            <table class="data-table data-table--albums" data-testid="albums-table">
                                <caption class="data-table__caption">Liste des albums The Weeknd</caption>
                                <thead>
                                    <tr>
                                        <th scope="col" data-sort-key="rank">
                                            <span class="data-table__header-text">#</span>
                                        </th>
                                        <th scope="col" data-sort-key="title" data-sort-type="title">
                                            <div class="data-table__header-wrapper">
                                                <button type="button" class="data-table__sort-button">
                                                    <span class="data-table__header-text">Albums</span>
                                                </button>
                                                <span class="data-table__legend">^ = compilation</span>
                                            </div>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="streams_total">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Streams totaux</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="streams_daily">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Streams quotidiens</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="variation_pct">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Variation (%)</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="days_to_next_cap">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Prochain cap (j)</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="next_cap_value">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Prochain palier</span>
                                            </button>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="data-table__cell--rank">1</td>
                                        <td class="data-table__cell--title">
                                            <div class="data-table__title-wrapper">
                                                <div class="data-table__title-cover">
                                                    <div class="cover-placeholder">💿</div>
                                                </div>
                                                <div class="data-table__title-meta">
                                                    <div class="data-table__song-name">
                                                        <a href="#album-detail/after-hours" data-album-link>After Hours</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="data-table__cell--numeric">15,123,456,789</td>
                                        <td class="data-table__cell--numeric">45,678,901</td>
                                        <td class="data-table__cell--numeric">
                                            <span class="data-table__delta--na">N.D.</span>
                                        </td>
                                        <td class="data-table__cell--numeric">—</td>
                                        <td class="data-table__cell--numeric">16B</td>
                                    </tr>
                                    <tr>
                                        <td class="data-table__cell--rank">2</td>
                                        <td class="data-table__cell--title">
                                            <div class="data-table__title-wrapper">
                                                <div class="data-table__title-cover">
                                                    <div class="cover-placeholder">💿</div>
                                                </div>
                                                <div class="data-table__title-meta">
                                                    <div class="data-table__song-name">
                                                        <a href="#album-detail/starboy" data-album-link>Starboy</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="data-table__cell--numeric">14,987,654,321</td>
                                        <td class="data-table__cell--numeric">38,765,432</td>
                                        <td class="data-table__cell--numeric">
                                            <span class="data-table__delta--na">N.D.</span>
                                        </td>
                                        <td class="data-table__cell--numeric">—</td>
                                        <td class="data-table__cell--numeric">15B</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                </div>

                <!-- Page Caps imminents (cachée par défaut) -->
                <div id="page-caps" class="page page--caps" data-page-content="caps" style="display: none;">
                    <!-- En-tête avec cartes meta (comme Songs/Albums) -->
                    <div class="page-header">
                        <div class="page-header__cards">
                            <div class="stat-card" data-testid="header-last-sync">
                                <div class="stat-card__label">Dernière sync locale</div>
                                <div class="stat-card__value">—</div>
                            </div>
                            <div class="stat-card nu-card" data-testid="header-next-update">
                                <div id="nu-tip-caps" class="nu-tooltip" role="tooltip" hidden>
                                    <strong>INFOS SYNCHRONISATION</strong><br>
                                    La synchro est limitée par un délai de sécurité. Prochaine mise à jour estimée à
                                    <span class="nu-eta">—</span>.
                                </div>
                                
                                <div class="nu-header">
                                    <span class="nu-title">MISE À JOUR DES DONNÉES</span>
                                    <button class="nu-info" type="button" aria-describedby="nu-tip-caps" aria-label="Informations"></button>
                                </div>
                                
                                <div class="nu-body">
                                    <span class="nu-badge" aria-live="polite">—</span>
                                </div>
                            </div>
                            <div class="stat-card" data-testid="header-spotify-data-date">
                                <div class="stat-card__label">Date des données actuelles</div>
                                <div class="stat-card__value">—</div>
                            </div>
                        </div>
                    </div>

                    <!-- Compteurs -->
                    <div class="page-header page-header--aggregate">
                        <div class="page-header__cards">
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label">Nombre total d'éléments</div>
                                <div class="stat-card__value" data-testid="caps-total-count">—</div>
                            </div>
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label" data-caps-label="songs">Nombre de titres</div>
                                <div class="stat-card__value" data-testid="caps-songs-count">—</div>
                            </div>
                            <div class="stat-card stat-card--aggregate">
                                <div class="stat-card__label" data-caps-label="albums">Nombre d'albums</div>
                                <div class="stat-card__value" data-testid="caps-albums-count">—</div>
                            </div>
                        </div>
                    </div>

                    <!-- Contrôles de filtrage -->
                    <div class="caps-controls">
                        <div class="caps-controls__group">
                            <label for="caps-window-select" class="caps-controls__label">Fenêtre temporelle</label>
                            <select id="caps-window-select" class="caps-controls__select" data-testid="caps-window-select">
                                <option value="7">7 jours</option>
                                <option value="14">14 jours</option>
                                <option value="30" selected>30 jours</option>
                                <option value="60">60 jours</option>
                            </select>
                        </div>
                        
                        <div class="caps-controls__group">
                            <span class="caps-controls__label">Afficher</span>
                            <div class="caps-controls__toggles">
                                <label class="caps-toggle">
                                    <input type="checkbox" id="caps-toggle-songs" checked data-testid="caps-toggle-songs">
                                    <span class="caps-toggle__label">Titres</span>
                                </label>
                                <label class="caps-toggle">
                                    <input type="checkbox" id="caps-toggle-albums" checked data-testid="caps-toggle-albums">
                                    <span class="caps-toggle__label">Albums</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Tableau -->
                    <section class="table-section">
                        <div class="table-wrapper table-wrapper--has-hscroll">
                            <table class="data-table data-table--caps" data-testid="caps-table">
                                <caption class="data-table__caption">Liste des caps imminents</caption>
                                <thead>
                                    <tr>
                                        <th scope="col" class="data-table__cell--numeric data-table__cell--rank" data-sort-key="rank">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">#</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--title" data-sort-key="title" data-sort-type="title">
                                            <div class="data-table__header-wrapper">
                                                <button type="button" class="data-table__sort-button">
                                                    <span class="data-table__header-text">Titres</span>
                                                </button>
                                                <span class="data-table__legend">* = featuring</span>
                                            </div>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="type">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Type</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="days_to_next_cap">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Prochain cap</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="eta">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Date prévue</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="streams_total">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Streams totaux</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="streams_daily">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Streams quotidiens</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="variation_pct">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Variation (%)</span>
                                            </button>
                                        </th>
                                        <th scope="col" class="data-table__cell--numeric" data-sort-key="next_cap_value">
                                            <button type="button" class="data-table__sort-button">
                                                <span class="data-table__header-text">Prochain palier</span>
                                            </button>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Rempli dynamiquement par caps.js -->
                                </tbody>
                            </table>
                        </div>
                    </section>
                </div>
            </div>
        </main>

        <!-- Barre de recherche sticky -->
        <div class="bottombar">
            <div class="bottombar__inner">
                <label for="search-input" class="bottombar__label">Rechercher</label>
                <input 
                    type="search" 
                    id="search-input" 
                    class="bottombar__input" 
                    placeholder="Rechercher un titre, album..."
                    aria-label="Rechercher un titre ou album"
                    data-testid="search-sticky"
                />
            </div>
        </div>
    </div>

    <script src="src/formatters.js?v=6.7"></script>
    <script src="src/data-loader.js?v=6.7"></script>
    <script src="src/data-renderer.js?v=8.0"></script>
    <script src="src/table-sort.js?v=7.10.1"></script>
    <script src="src/meta-refresh.js?v=6.7"></script>
    <script src="src/caps.js?v=7.10.1"></script>
    <script src="src/search.js?v=6.7"></script>
    <script src="src/main.js?v=6.7"></script>
    <script src="src/app.js?v=6.7"></script>
</body>
</html>
